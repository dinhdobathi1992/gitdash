{{- if .Values.secret.create }}
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "gitdash.fullname" . }}
  namespace: {{ include "gitdash.namespace" . }}
  labels:
    {{- include "gitdash.labels" . | nindent 4 }}
  annotations:
    helm.sh/resource-policy: keep   # keep secret on helm uninstall to avoid data loss
type: Opaque
stringData:
  SESSION_SECRET: {{ required "secret.sessionSecret must be set" .Values.secret.sessionSecret | quote }}
  {{- if .Values.secret.githubClientId }}
  GITHUB_CLIENT_ID: {{ .Values.secret.githubClientId | quote }}
  {{- end }}
  {{- if .Values.secret.githubClientSecret }}
  GITHUB_CLIENT_SECRET: {{ .Values.secret.githubClientSecret | quote }}
  {{- end }}
{{- end }}
